# on: push
# jobs:
#   first-job:
#     runs-on: windows-latest
#     steps:
#       - run: node --version
#       - run: npm --version

name: MongoDB CRUD Operations

on:
  # Triggers the workflow on a push event to the main branch
  push:
    branches:
      - main
  # Allows manual triggering of the workflow
  workflow_dispatch:

jobs:
  perform-crud-operations:
    # Run the job on the latest Windows environment
    runs-on: windows-latest
    steps:
    # Step to check out the repository's code
    - name: Checkout code
      uses: actions/checkout@v3  # Updated to version 3 of actions/checkout

    # Step to set up Node.js 20
    - name: Set up Node.js 20
      uses: actions/setup-node@v3  # Use the same version as before, setup-node version 3 supports Node.js 20
      with:
        node-version: '20'  # Specifying Node.js version 20

    # Step to install dependencies (if any)
    - name: Install dependencies
      run: npm install  # Modify or remove this line as per your project needs

    # Step to run CRUD operations directly using MongoDB shell commands
    - name: Run CRUD operations
      run: |
        # Define your MongoDB connection URI, e.g., mongodb://username:password@host:port/dbname
        $mongo_uri = "mongodb://username:password@localhost:27017/mydb"
        
        # Example CRUD operations:
        # Create a document in the 'users' collection
        echo 'db.users.insert({ name: "Alice", age: 30 })' | mongo $mongo_uri
        
        # Read documents from the 'users' collection
        echo 'db.users.find({})' | mongo $mongo_uri
        
        # Update a document in the 'users' collection
        echo 'db.users.updateOne({ name: "Alice" }, { $set: { age: 31 } })' | mongo $mongo_uri
        
        # Delete a document from the 'users' collection
        echo 'db.users.deleteOne({ name: "Alice" })' | mongo $mongo_uri
        
        # Add more MongoDB shell commands as needed